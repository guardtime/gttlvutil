.TH GTTLVUNDUMP 1
.\"
.\"
.\"
.SH NAME
\fBgttlvundump \fR- A tool for constructing TLV file from gttlvdump style input.
.\"
.\"
.SH SYNOPSIS
.\"
.HP 4
\fBgttlvundump \fR[\fB-h\fR] \fR[\fB-v\fR] [\fItlvfile\fR]...
.LP
.\"
.\"
.SH DESCRIPTION
.\"
gttlvundump is a tool that constructs a binary TLV file from gttlvdump style input. Input is read from \fIstdin \fRif input file is not specified. When multiple input files are specified the result is concatenated starting from the first (left-most) file. The output is dumped to the \fIstdout\fR.
.LP
See \fBgttlvdump\fR(1) to learn about the expected format. It must be noted that only basic output format of \fBgttlvdump\fR is accepted as input.
.LP
It is possible to use functions in TLV files. For detailed description of supported functions see \fBFUNCTIONS\fR section. To use a function it has to be preceeded with '$' sign, eg. \fI$FUNC(arg)\fR. Function arguments are delimited with '|' sign.
.br
.\"
.\"
.SH OPTIONS
.\"
.TP
\fB-h\fR
Prints help text to \fIstdout\fR.
.\"
.TP
\fB-v\fR
TLV utility package version.
.\"
.\"
.SH FUNCTIONS
.\"
.TP
\fBHMAC(\fIversion\fR|\fIalgorithm\fR|\fIkey\fR|\fIpattern\fB)\fR
Calculate HMAC value on a PDU.
.\"
.RS
.TP
\fIversion\fR
PDU HMAC calculation version. Valid versions:
.br
\fIv1\fR - computation is performed over the concatenation of header and payload TLVs.
.br
\fIv2\fR - computation is performed over the TLV header of the PDU, the complete header TLV, complete payload TLVs in the order in which they appear within the PDU, and the TLV header and the hash function ID of the MAC element itself.
.\"
.TP
\fIalgorithm\fR
Hash algorithm to be used for calculation. Use \fB-h\fR to get the list of supported hash algorithms.
.\"
.TP
\fIkey\fR
Secret cryptographic key.
.\"
.TP
\fIpattern\fR
TLV pattern describing TLVs to be included into calculation (valid with \fIv1\fR). Pattern format as defined by gttlvgrep.
.RE
.\"
.\"
.SH EXAMPLES
.\"
.TP 3
\fB1
\fRGenerate a TLV file from the given input file and dump the result with gttlvdump:
.LP
.RS 4
File \fItest.tlv\fR contains following TLV structure description.
.LP
TLV[1000]:
  TLV[01]:
    TLV[01]:0a
    TLV[01]:0b

.HP 4
\fBgttlvundump \fItest.tlv \fR| \fBgttlvdump\fR
.RE
.\"
.TP 3
\fB2
\fRTo concatenate two TLV's described in a.tlv and b.tlv and dump the result with gttlvdump: 
.LP
.RS 4
.HP 4
\fBgttlvundump \fIa.tlv \fIb.tlv \fR| \fBgttlvdump\fR
.RE
.TP 3
\fB3
\fRTo calculate HMAC value on a PDU:
.LP
.RS 4
1. PDU \fIv1\fR HMAC calculation.
  TLV[0300]:
    TLV[01]:
      TLV[01]:616E6F6E00
    TLV[0301]:
      TLV[01]:01
      TLV[02]:54D9D6E7
      TLV[03]:54D9D6E7
    TLV[1f]:\fI$HMAC(v1|sha256|anon|300.01,301)\fR
.LP
2. PDU \fIv2\fR HMAC calculation.
  TLV[0300]:
    TLV[01]:
      TLV[01]:616E6F6E00
    TLV[0301]:
      TLV[01]:01
      TLV[02]:54D9D6E7
      TLV[03]:54D9D6E7
    TLV[1f]:\fI$HMAC(v2|sha256|anon)\fR
.RE
.LP
.\"
.SH AUTHOR
.LP
Guardtime AS, http://www.guardtime.com/
.LP
.SH SEE ALSO
.LP
\fBgttlvdump\fR(1), \fBgttlvgrep\fR(1), \fBgttlvwrap\fR(1), \fBtlv\fR(5), \fBtlv-desc\fR(5)
